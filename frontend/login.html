<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthTrack Systems - Iniciar Sesion</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Login-only polish */
        .login-page {
            position: relative;
            overflow: hidden;
        }
        .login-page::before,
        .login-page::after {
            content: '';
            position: absolute;
            border-radius: 999px;
            filter: blur(40px);
            opacity: 0.25;
            pointer-events: none;
        }
        .login-page::before {
            width: 260px; height: 260px;
            background: #4caf50;
            top: -40px; left: -60px;
        }
        .login-page::after {
            width: 320px; height: 320px;
            background: #2196f3;
            bottom: -90px; right: -40px;
        }
        
        .login-logo {
            text-align: center;
            margin-bottom: 22px;
        }
        
        .login-logo img {
            max-width: 300px;
            height: auto;
            margin-bottom: 6px;
        }
        
        .login-tagline {
            color: #1a3a5c;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.4px;
            margin-top: 8px;
        }

        /* Login card theming */
        .login-card {
            background: #ffffff;
            color: #1a3a5c;
        }

        .login-card p,
        .login-card label {
            color: #1a3a5c;
        }

        .login-card .btn-primary {
            background: #2c5f8d;
            border-color: #2c5f8d;
            color: #fff;
        }

        .login-card .btn-primary:hover {
            background: #1f4a73;
            border-color: #1f4a73;
        }

        .test-credentials {
            background: #eef4ff !important;
            border: 1px solid #d0ddff !important;
            color: #1a3a5c !important;
        }

        .test-credentials code {
            background: #1a3a5c !important;
            color: #fff !important;
        }

        .d-none {
            display: none !important;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-card">
            <div class="login-logo">
            <img src="img/healthtrack-logo.png" alt="HealthTrack Systems" loading="lazy">
                <p class="login-tagline">Control, precision y bienestar.</p>
            </div>
            
            <div class="login-header">
                <h1>Sistema de Gestion Farmaceutica</h1>
                <p>Ingrese sus credenciales para continuar</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username" data-i18n="user">Usuario</label>
                    <input type="text" 
                           id="username" 
                           class="form-control" 
                           placeholder="Ingrese su nombre de usuario" 
                           required 
                           autocomplete="username">
                </div>
                
                <div class="form-group">
                    <label for="password">Contrasena</label>
                    <input type="password" 
                           id="password" 
                           class="form-control" 
                           placeholder="Ingrese su contrasena" 
                           required
                           autocomplete="current-password">
                </div>
                
                <button type="submit" class="btn btn-primary btn-block btn-lg">
                    Iniciar Sesion
                </button>
                
                <div id="errorMsg" class="error-msg d-none"></div>
                
                <div id="loadingSpinner" class="spinner d-none"></div>
            </form>
            
            <div class="test-credentials">
                <p><strong><i class="fas fa-circle"></i> Credenciales de Prueba:</strong></p>
                <p><strong>Farmaceutico:</strong></p>
                <p>Usuario: <code>JD12345</code></p>
                <p>Contrasena: <code>JOHND_HASH_12345</code></p>
                <hr class="divider">
                <p><strong>Administrador:</strong></p>
                <p>Usuario: <code>admin</code></p>
                <p>Contrasena: <code>ADMIN_HASH_12345</code></p>
            </div>
        </div>
        
        <p class="footer-copyright">
            &copy; 2025 HealthTrack Systems. Todos los derechos reservados.
        </p>
    </div>
    
    <script src="js/auth.js"></script>
    <script>
    // Show Users menu item only for admins
    document.addEventListener('DOMContentLoaded', async () => {
        const response = await fetch('/api/auth/session');
        const data = await response.json();
        
        if (data.loggedIn && data.user && data.user.roleName === 'Administrator') {
            const usersNavItem = document.getElementById('usersNavItem');
            if (usersNavItem) {
                usersNavItem.classList.remove('d-none');
            }
        }
    });
    </script>
    <script src="js/language.js"></script>
</body>
</html>
